<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/layout}"
>
  <head>
    <meta charset="UTF-8" th:remove="tag" />
  </head>
  <body>
    <div layout:fragment="content">
      <div
        th:if="${success}"
        th:text="${success}"
        class="alert alert-success"
        role="alert"
      ></div>
      <div
        th:if="${error}"
        th:text="${error}"
        class="alert alert-danger"
        role="alert"
      ></div>
      <h1 class="page-header">イベント詳細</h1>
      <table class="table table-striped" cellpadding="0" cellspacing="0">
        <thead class="bg-primary text-white">
          <tr>
            <th scope="col">ID</th>
            <th scope="col">イベント名</th>
            <th scope="col">最大参加者数</th>
            <th scope="col">カテゴリ</th>
            <th scope="col">管理ユーザ</th>
            <th scope="col">作成日時</th>
            <th scope="col">更新日時</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td th:text="${event.id}"></td>
            <td th:text="${event.name}"></td>
            <td th:text="${event.maxParticipant}"></td>
            <td th:text="${event.category.name}"></td>
            <td th:text="${event.user.email}"></td>
            <td
              th:text="${#temporals.format(event.createdAt, 'yyyy年MM月dd日HH時mm分ss秒')}"
            ></td>
            <td
              th:text="${#temporals.format(event.modifiedAt, 'yyyy年MM月dd日HH時mm分ss秒')}"
            ></td>
          </tr>
        </tbody>
      </table>

      <div class="text-center container-fluid bg-info">
        <h1 class="p-3">現在の参加者数: [[${event.users.size()}]] 名</h1>
      </div>

      <h1 class="page-header">イベント参加者</h1>
      <table class="table table-striped" cellpadding="0" cellspacing="0">
        <thead class="bg-primary text-white">
          <tr>
            <th scope="col">ユーザーID</th>
            <th scope="col">ユーザー名</th>
            <th scope="col">作成日時</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="user : ${event.users}">
            <td th:text="${user.id}"></td>
            <td th:text="${user.email}"></td>
            <td
              th:text="${#temporals.format(user.createdAt, 'yyyy年MM月dd日HH時mm分ss秒')}"
            ></td>
          </tr>
        </tbody>
      </table>
      <div>
        <th:block th:if="${true}">
          <form
            th:action="@{/admin/eventusers/create/{id}(id=${event.id})}"
            method="post"
          >
            <input class="mt-3 btn btn-primary" type="submit" th:value="参加" />
          </form>
        </th:block>
        <th:block th:unless="${false}">
          <a
            th:href="@{/admin/chats/talk/{id}(id=${event.id})}"
            class="btn btn-primary"
            >チャットに参加する</a
          >
          <form
            th:action="@{/admin/eventusers/delete/{id}(id=${event.id})}"
            method="post"
          >
            <input
              class="mt-3 btn btn-danger"
              type="submit"
              th:value="辞退する"
            />
          </form>
        </th:block>
      </div>
    </div>
  </body>
</html>
